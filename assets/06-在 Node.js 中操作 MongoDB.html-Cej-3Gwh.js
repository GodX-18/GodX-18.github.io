import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as p,c,b as n,e as s,d as t,a as l}from"./app-oXp7PBbS.js";const i={},r=n("p",null,"参考：",-1),u={href:"https://www.mongodb.com/docs/drivers/",target:"_blank",rel:"noopener noreferrer"},d={href:"https://www.mongodb.com/docs/drivers/node/current/usage-examples/",target:"_blank",rel:"noopener noreferrer"},k=l(`<h2 id="初始化示例项目" tabindex="-1"><a class="header-anchor" href="#初始化示例项目"><span>初始化示例项目</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> node-mongodb-demo

<span class="token builtin class-name">cd</span> node-mongodb-demo

<span class="token function">npm</span> init <span class="token parameter variable">-y</span>

<span class="token function">npm</span> <span class="token function">install</span> mongodb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="连接到-mongodb" tabindex="-1"><a class="header-anchor" href="#连接到-mongodb"><span>连接到 MongoDB</span></a></h2><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> MongoClient <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Replace the uri string with your connection string.</span>
<span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token string">&quot;mongodb://127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> database <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&#39;sample_mflix&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> movies <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&#39;movies&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Query for a movie that has the title &#39;Back to the Future&#39;</span>
    <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Back to the Future&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> movie <span class="token operator">=</span> <span class="token keyword">await</span> movies<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token comment">// Ensures that the client will close when you finish/error</span>
    <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="crud-操作" tabindex="-1"><a class="header-anchor" href="#crud-操作"><span>CRUD 操作</span></a></h2><p>CRUD（创建，读取，更新，删除）操作使您可以处理存储在 MongoDB 中的数据。</p><h3 id="创建文档" tabindex="-1"><a class="header-anchor" href="#创建文档"><span>创建文档</span></a></h3><p>插入一个：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> pizzaDocument <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Neapolitan pizza&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> <span class="token string">&quot;round&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">toppings</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;San Marzano tomatoes&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mozzarella di bufala cheese&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> pizzaCollection<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span>pizzaDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>insertedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>插入多个：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> pizzaDocuments <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Sicilian pizza&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">shape</span><span class="token operator">:</span> <span class="token string">&quot;square&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;New York pizza&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">shape</span><span class="token operator">:</span> <span class="token string">&quot;round&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Grandma pizza&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">shape</span><span class="token operator">:</span> <span class="token string">&quot;square&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> pizzaCollection<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>pizzaDocuments<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>insertedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询文档" tabindex="-1"><a class="header-anchor" href="#查询文档"><span>查询文档</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>  <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;zx&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 查询所有，返回值为 promise 对象</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> testDb<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 查询单个（只返回查到的第一个值）</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">await</span> testDb<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除文档" tabindex="-1"><a class="header-anchor" href="#删除文档"><span>删除文档</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageViews</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">$gt</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">32768</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 删除符合条件的单个文档</span>
<span class="token keyword">const</span> deleteResult <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>deleteResult<span class="token punctuation">.</span>deletedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除符合条件的多个文档</span>
<span class="token keyword">const</span> deleteManyResult <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>deleteManyResult<span class="token punctuation">.</span>deletedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改文档" tabindex="-1"><a class="header-anchor" href="#修改文档"><span>修改文档</span></a></h3><p>更新1个文档：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token number">465</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// update the value of the &#39;z&#39; field to 42</span>
<span class="token keyword">const</span> updateDocument <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 更新多个</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> updateDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 更新多个</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">updateMany</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> updateDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>替换文档：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token number">465</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// replace the matched document with the replacement document</span>
<span class="token keyword">const</span> replacementDocument <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">replaceOne</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> replacementDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20);function m(v,b){const a=o("ExternalLinkIcon");return p(),c("div",null,[r,n("ul",null,[n("li",null,[s("在服务端操作 MongoDB："),n("a",u,[s("https://www.mongodb.com/docs/drivers/"),t(a)])]),n("li",null,[s("在 Node.js 中操作 MongoDB："),n("a",d,[s("https://www.mongodb.com/docs/drivers/node/current/usage-examples/"),t(a)])])]),k])}const y=e(i,[["render",m],["__file","06-在 Node.js 中操作 MongoDB.html.vue"]]),w=JSON.parse('{"path":"/%E5%A4%A7%E5%89%8D%E7%AB%AF/Nodejs%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/MongoDB/06-%E5%9C%A8%20Node.js%20%E4%B8%AD%E6%93%8D%E4%BD%9C%20MongoDB.html","title":"在 Node.js 中操作 MongoDB","lang":"zh-CN","frontmatter":{"title":"在 Node.js 中操作 MongoDB","order":6,"category":["前端"],"tag":["数据库","noSQL"],"description":"参考： 在服务端操作 MongoDB：https://www.mongodb.com/docs/drivers/ 在 Node.js 中操作 MongoDB：https://www.mongodb.com/docs/drivers/node/current/usage-examples/ 初始化示例项目 连接到 MongoDB CRUD 操作 CRUD...","head":[["meta",{"property":"og:url","content":"https://godx-18.github.io/%E5%A4%A7%E5%89%8D%E7%AB%AF/Nodejs%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/MongoDB/06-%E5%9C%A8%20Node.js%20%E4%B8%AD%E6%93%8D%E4%BD%9C%20MongoDB.html"}],["meta",{"property":"og:site_name","content":"烜"}],["meta",{"property":"og:title","content":"在 Node.js 中操作 MongoDB"}],["meta",{"property":"og:description","content":"参考： 在服务端操作 MongoDB：https://www.mongodb.com/docs/drivers/ 在 Node.js 中操作 MongoDB：https://www.mongodb.com/docs/drivers/node/current/usage-examples/ 初始化示例项目 连接到 MongoDB CRUD 操作 CRUD..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-22T00:58:07.000Z"}],["meta",{"property":"article:author","content":"GodX"}],["meta",{"property":"article:tag","content":"数据库"}],["meta",{"property":"article:tag","content":"noSQL"}],["meta",{"property":"article:modified_time","content":"2023-11-22T00:58:07.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在 Node.js 中操作 MongoDB\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-11-22T00:58:07.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"GodX\\",\\"url\\":\\"https://github.com/GodX-18\\"}]}"]]},"headers":[{"level":2,"title":"初始化示例项目","slug":"初始化示例项目","link":"#初始化示例项目","children":[]},{"level":2,"title":"连接到 MongoDB","slug":"连接到-mongodb","link":"#连接到-mongodb","children":[]},{"level":2,"title":"CRUD 操作","slug":"crud-操作","link":"#crud-操作","children":[{"level":3,"title":"创建文档","slug":"创建文档","link":"#创建文档","children":[]},{"level":3,"title":"查询文档","slug":"查询文档","link":"#查询文档","children":[]},{"level":3,"title":"删除文档","slug":"删除文档","link":"#删除文档","children":[]},{"level":3,"title":"修改文档","slug":"修改文档","link":"#修改文档","children":[]}]}],"git":{"createdTime":1700614687000,"updatedTime":1700614687000,"contributors":[{"name":"GodX","email":"1046529973@qq.com","commits":1}]},"readingTime":{"minutes":1.37,"words":411},"filePathRelative":"大前端/Nodejs全栈开发/MongoDB/06-在 Node.js 中操作 MongoDB.md","localizedDate":"2023年11月22日","excerpt":"<p>参考：</p>\\n<ul>\\n<li>在服务端操作 MongoDB：<a href=\\"https://www.mongodb.com/docs/drivers/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.mongodb.com/docs/drivers/</a></li>\\n<li>在 Node.js 中操作 MongoDB：<a href=\\"https://www.mongodb.com/docs/drivers/node/current/usage-examples/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.mongodb.com/docs/drivers/node/current/usage-examples/</a></li>\\n</ul>","autoDesc":true}');export{y as comp,w as data};
